# 🎯 다운로드 제한 시스템 QA 시나리오

## 📋 테스트 개요
- **테스트 대상**: 다운로드 제한 시스템 (useDownloadLimits, DownloadButton, AdModal, EmailCollectionModal)
- **테스트 범위**: 정상 케이스, 엣지케이스, 경계값 테스트
- **테스트 환경**: 프론트엔드 (React + TypeScript)

## 🎯 테스트 목표
1. 다운로드 제한 로직 정확성 검증
2. 광고 시청 후 다운로드 허용 확인
3. 이메일 수집 후 다운로드 허용 확인
4. localStorage 데이터 지속성 검증
5. 엣지케이스 및 예외 상황 처리 확인

---

## 📊 테스트 시나리오

### 1️⃣ **기본 다운로드 제한 테스트**

#### 1.1 초기 상태 테스트
- **목적**: 사용자가 처음 방문했을 때의 상태 확인
- **예상 결과**: 
  - 다운로드 횟수: 0
  - 광고 시청 횟수: 0
  - 이메일 수집 상태: false
  - 다운로드 가능: true (2회까지)

#### 1.2 1-2회 다운로드 테스트
- **목적**: 무료 다운로드 2회까지 정상 작동 확인
- **테스트 케이스**:
  - 1회 다운로드 후 상태 확인
  - 2회 다운로드 후 상태 확인
- **예상 결과**: 
  - 1-2회: 다운로드 성공, 제한 없음
  - 2회 후: 광고 시청 필요

#### 1.3 3-5회 다운로드 테스트 (광고 시청)
- **목적**: 광고 시청 후 다운로드 허용 확인
- **테스트 케이스**:
  - 3회 다운로드 시도 → 광고 모달 표시
  - 광고 시청 완료 → 다운로드 허용
  - 4-5회 다운로드 → 광고 시청 필요
- **예상 결과**: 
  - 3회: 광고 모달 표시, 다운로드 차단
  - 광고 시청 후: 다운로드 허용
  - 4-5회: 광고 시청 필요

#### 1.4 6회 이상 다운로드 테스트 (이메일 수집)
- **목적**: 이메일 수집 후 다운로드 허용 확인
- **테스트 케이스**:
  - 6회 다운로드 시도 → 이메일 수집 모달 표시
  - 이메일 수집 완료 → 다운로드 허용
  - 7회 이상 다운로드 → 이메일 수집 필요
- **예상 결과**: 
  - 6회: 이메일 수집 모달 표시, 다운로드 차단
  - 이메일 수집 후: 다운로드 허용
  - 7회 이상: 이메일 수집 필요

---

### 2️⃣ **엣지케이스 테스트**

#### 2.1 localStorage 데이터 손상 테스트
- **목적**: localStorage 데이터가 손상되었을 때의 처리 확인
- **테스트 케이스**:
  - localStorage 데이터를 잘못된 형식으로 설정
  - localStorage 데이터를 null로 설정
  - localStorage 데이터를 빈 객체로 설정
- **예상 결과**: 
  - 기본값으로 초기화
  - 오류 없이 정상 작동

#### 2.2 localStorage 접근 불가 테스트
- **목적**: localStorage에 접근할 수 없을 때의 처리 확인
- **테스트 케이스**:
  - localStorage를 null로 설정
  - localStorage.setItem을 오버라이드하여 오류 발생
  - localStorage.getItem을 오버라이드하여 오류 발생
- **예상 결과**: 
  - 오류 없이 기본값 사용
  - 메모리 상태로만 동작

#### 2.3 동시 다운로드 시도 테스트
- **목적**: 여러 다운로드가 동시에 시도될 때의 처리 확인
- **테스트 케이스**:
  - 빠른 연속 클릭 (0.1초 간격)
  - 중복 다운로드 시도
  - 다운로드 중 추가 시도
- **예상 결과**: 
  - 중복 카운트 방지
  - 순차적 처리
  - 상태 일관성 유지

#### 2.4 네트워크 오류 테스트
- **목적**: 다운로드 중 네트워크 오류 발생 시 처리 확인
- **테스트 케이스**:
  - 다운로드 중 네트워크 연결 끊김
  - 서버 오류 응답 (500, 404 등)
  - 타임아웃 발생
- **예상 결과**: 
  - 카운트 증가하지 않음
  - 오류 메시지 표시
  - 재시도 가능

#### 2.5 브라우저 새로고침 테스트
- **목적**: 페이지 새로고침 후 상태 유지 확인
- **테스트 케이스**:
  - 다운로드 1회 후 새로고침
  - 광고 시청 후 새로고침
  - 이메일 수집 후 새로고침
- **예상 결과**: 
  - 상태 정확히 유지
  - localStorage 데이터 정상 로드

---

### 3️⃣ **경계값 테스트**

#### 3.1 정확한 제한 횟수 테스트
- **목적**: 정확히 2회, 5회에서 제한이 적용되는지 확인
- **테스트 케이스**:
  - 2회 다운로드 후 3회 시도
  - 5회 다운로드 후 6회 시도
- **예상 결과**: 
  - 2회 후: 광고 모달 표시
  - 5회 후: 이메일 수집 모달 표시

#### 3.2 광고 시청 횟수 테스트
- **목적**: 광고 시청 횟수가 정확히 카운트되는지 확인
- **테스트 케이스**:
  - 광고 시청 1회 후 상태 확인
  - 광고 시청 2회 후 상태 확인
- **예상 결과**: 
  - 광고 시청 횟수 정확히 카운트
  - 3회마다 광고 시청 필요

#### 3.3 이메일 수집 상태 테스트
- **목적**: 이메일 수집 상태가 정확히 저장되는지 확인
- **테스트 케이스**:
  - 이메일 수집 완료 후 상태 확인
  - 이메일 수집 후 다운로드 시도
- **예상 결과**: 
  - 이메일 수집 상태 true로 저장
  - 이메일 수집 후 다운로드 허용

---

### 4️⃣ **사용자 경험 테스트**

#### 4.1 모달 표시 테스트
- **목적**: 모달이 적절한 시점에 표시되는지 확인
- **테스트 케이스**:
  - 광고 모달 표시 시점
  - 이메일 수집 모달 표시 시점
  - 모달 닫기 후 상태 확인
- **예상 결과**: 
  - 정확한 시점에 모달 표시
  - 모달 닫기 후 상태 유지

#### 4.2 모달 닫기 테스트
- **목적**: 모달을 닫았을 때의 처리 확인
- **테스트 케이스**:
  - 광고 모달을 닫고 다운로드 시도
  - 이메일 수집 모달을 닫고 다운로드 시도
  - ESC 키로 모달 닫기
- **예상 결과**: 
  - 모달 닫기 후 다운로드 차단
  - 모달 재표시 필요

#### 4.3 모달 완료 테스트
- **목적**: 모달 완료 후 다운로드 허용 확인
- **테스트 케이스**:
  - 광고 시청 완료 후 다운로드
  - 이메일 수집 완료 후 다운로드
- **예상 결과**: 
  - 모달 완료 후 다운로드 허용
  - 상태 정확히 업데이트

---

### 5️⃣ **데이터 무결성 테스트**

#### 5.1 localStorage 동기화 테스트
- **목적**: localStorage와 메모리 상태가 동기화되는지 확인
- **테스트 케이스**:
  - 다운로드 후 localStorage 확인
  - 광고 시청 후 localStorage 확인
  - 이메일 수집 후 localStorage 확인
- **예상 결과**: 
  - localStorage와 메모리 상태 일치
  - 데이터 정확히 저장

#### 5.2 상태 초기화 테스트
- **목적**: 상태 초기화가 정확히 작동하는지 확인
- **테스트 케이스**:
  - localStorage 초기화 후 상태 확인
  - 브라우저 캐시 삭제 후 상태 확인
- **예상 결과**: 
  - 기본값으로 초기화
  - 정상 작동

---

### 6️⃣ **성능 테스트**

#### 6.1 대량 다운로드 테스트
- **목적**: 많은 다운로드 시도 시 성능 확인
- **테스트 케이스**:
  - 100회 연속 다운로드 시도
  - 빠른 연속 클릭 (1초에 10회)
- **예상 결과**: 
  - 성능 저하 없음
  - 정확한 카운트 유지

#### 6.2 메모리 사용량 테스트
- **목적**: 메모리 사용량이 적절한지 확인
- **테스트 케이스**:
  - 장시간 사용 후 메모리 사용량 확인
  - 대량 데이터 처리 후 메모리 사용량 확인
- **예상 결과**: 
  - 메모리 누수 없음
  - 적절한 메모리 사용량

---

## 🧪 테스트 실행 방법

### 자동화 테스트
```bash
# 프론트엔드 테스트 실행
cd frontend
npm test

# E2E 테스트 실행
npm run test:e2e
```

### 수동 테스트
1. 브라우저에서 애플리케이션 실행
2. 개발자 도구에서 localStorage 확인
3. 각 시나리오별로 수동 테스트 실행

### 테스트 데이터 초기화
```javascript
// localStorage 초기화
localStorage.clear();

// 특정 데이터만 초기화
localStorage.removeItem('downloadLimits');
```

---

## 📊 테스트 결과 기록

### 테스트 실행 체크리스트
- [ ] 1.1 초기 상태 테스트
- [ ] 1.2 1-2회 다운로드 테스트
- [ ] 1.3 3-5회 다운로드 테스트
- [ ] 1.4 6회 이상 다운로드 테스트
- [ ] 2.1 localStorage 데이터 손상 테스트
- [ ] 2.2 localStorage 접근 불가 테스트
- [ ] 2.3 동시 다운로드 시도 테스트
- [ ] 2.4 네트워크 오류 테스트
- [ ] 2.5 브라우저 새로고침 테스트
- [ ] 3.1 정확한 제한 횟수 테스트
- [ ] 3.2 광고 시청 횟수 테스트
- [ ] 3.3 이메일 수집 상태 테스트
- [ ] 4.1 모달 표시 테스트
- [ ] 4.2 모달 닫기 테스트
- [ ] 4.3 모달 완료 테스트
- [ ] 5.1 localStorage 동기화 테스트
- [ ] 5.2 상태 초기화 테스트
- [ ] 6.1 대량 다운로드 테스트
- [ ] 6.2 메모리 사용량 테스트

### 버그 발견 시 기록
- **버그 ID**: BUG-001
- **발견 시나리오**: 1.2 1-2회 다운로드 테스트
- **버그 설명**: 2회 다운로드 후 상태가 정확히 업데이트되지 않음
- **재현 단계**: 
  1. 1회 다운로드
  2. 2회 다운로드
  3. 상태 확인
- **예상 결과**: 다운로드 횟수 2, 광고 시청 필요
- **실제 결과**: 다운로드 횟수 1, 광고 시청 불필요
- **우선순위**: 높음
- **상태**: 수정 필요

---

## 🎯 성공 기준

### 기능적 요구사항
- ✅ 다운로드 제한이 정확히 작동
- ✅ 광고 시청 후 다운로드 허용
- ✅ 이메일 수집 후 다운로드 허용
- ✅ localStorage 데이터 지속성
- ✅ 엣지케이스 처리

### 비기능적 요구사항
- ✅ 성능 저하 없음
- ✅ 메모리 누수 없음
- ✅ 사용자 경험 우수
- ✅ 오류 처리 적절

### 품질 요구사항
- ✅ 코드 품질 우수
- ✅ 테스트 커버리지 90% 이상
- ✅ 문서화 완료
- ✅ 유지보수성 우수

